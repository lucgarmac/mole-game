import{a as se,b as ae,c as ce}from"./chunk-VSG5BIXN.js";import{a as le}from"./chunk-OBNG2VUJ.js";import{$a as R,C as l,Da as q,E as j,Ea as Y,Fa as J,Ga as Q,J as U,M as g,Ma as X,N as W,O as L,Pa as ee,Qa as te,R as N,U as $,Va as C,W as A,X as D,Za as re,_ as y,a as F,ba as G,bb as ie,cb as ne,g as E,ia as B,j as _,k as w,l as x,la as K,na as P,o as p,pa as Z,qa as H,s as V,sb as k,t as S,ub as oe,v as T,w as M,x as f,xb as pe,y as d,ya as z}from"./chunk-7MNNHFH5.js";var ue=(r,e)=>{let i=D(pe),t=D(ae),{username:n}=i.userData;return n?!0:t.navigate(["/home"])};var fe=[{path:"",pathMatch:"full",redirectTo:"home"},{path:"home",loadComponent:()=>import("./chunk-FGESSAU5.js").then(r=>r.HomeComponent)},{path:"game",loadComponent:()=>import("./chunk-WAOSROZF.js").then(r=>r.GameComponent),canActivate:[ue]},{path:"**",pathMatch:"full",redirectTo:"home"}];var b="Service workers are disabled or not supported by this browser";function be(r){return S(()=>x(new Error(r)))}var h=class{constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=be(b);else{let t=T(e,"controllerchange").pipe(p(()=>e.controller)),n=S(()=>w(e.controller)),o=V(n,t);this.worker=o.pipe(d(u=>!!u)),this.registration=this.worker.pipe(g(()=>e.getRegistration()));let m=T(e,"message").pipe(p(u=>u.data)).pipe(d(u=>u&&u.type)).pipe(U());m.connect(),this.events=m}}postMessage(e,i){return this.worker.pipe(l(1),L(t=>{t.postMessage(F({action:e},i))})).toPromise().then(()=>{})}postMessageWithOperation(e,i,t){let n=this.waitForOperationCompleted(t),o=this.postMessage(e,i);return Promise.all([o,n]).then(([,a])=>a)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let i;return typeof e=="string"?i=t=>t.type===e:i=t=>e.includes(t.type),this.events.pipe(d(i))}nextEventOfType(e){return this.eventsOfType(e).pipe(l(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(d(i=>i.nonce===e),l(1),p(i=>{if(i.result!==void 0)return i.result;throw new Error(i.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},Ee=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new E,!t.isEnabled){this.messages=f,this.notificationClicks=f,this.subscription=f;return}this.messages=this.sw.eventsOfType("PUSH").pipe(p(o=>o.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(p(o=>o.data)),this.pushManager=this.sw.registration.pipe(p(o=>o.pushManager));let n=this.pushManager.pipe(g(o=>o.getSubscription()));this.subscription=M(n,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(b));let n={userVisibleOnly:!0},o=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),a=new Uint8Array(new ArrayBuffer(o.length));for(let s=0;s<o.length;s++)a[s]=o.charCodeAt(s);return n.applicationServerKey=a,this.pushManager.pipe(g(s=>s.subscribe(n)),l(1)).toPromise().then(s=>(this.subscriptionChanges.next(s),s))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(b));let t=n=>{if(n===null)throw new Error("Not subscribed to push notifications.");return n.unsubscribe().then(o=>{if(!o)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(l(1),g(t)).toPromise()}decodeBase64(t){return atob(t)}};e.\u0275fac=function(n){return new(n||e)(A(h))},e.\u0275prov=N({token:e,factory:e.\u0275fac});let r=e;return r})(),we=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=f,this.unrecoverable=f;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(b));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(b));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}};e.\u0275fac=function(n){return new(n||e)(A(h))},e.\u0275prov=N({token:e,factory:e.\u0275fac});let r=e;return r})();var he=new $("");function ye(r,e,i,t){return()=>{if(!(k(t)&&"serviceWorker"in navigator&&i.enabled!==!1))return;let n=r.get(K),o=r.get(R);n.runOutsideAngular(()=>{let s=navigator.serviceWorker,c=()=>s.controller?.postMessage({action:"INITIALIZE"});s.addEventListener("controllerchange",c),o.onDestroy(()=>{s.removeEventListener("controllerchange",c)})});let a;if(typeof i.registrationStrategy=="function")a=i.registrationStrategy();else{let[s,...c]=(i.registrationStrategy||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":a=w(null);break;case"registerWithDelay":a=me(+c[0]||0);break;case"registerWhenStable":let m=_(r.get(R).whenStable());a=c[0]?M(m,me(+c[0])):m;break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${i.registrationStrategy}`)}}n.runOutsideAngular(()=>a.pipe(l(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:i.scope}).catch(s=>console.error("Service worker registration failed with:",s))))}}function me(r){return w(null).pipe(j(r))}function Ce(r,e){return new h(k(e)&&r.enabled!==!1?navigator.serviceWorker:void 0)}var v=class{};function ge(r,e={}){return G([Ee,we,{provide:he,useValue:r},{provide:v,useValue:e},{provide:h,useFactory:Ce,deps:[v,P]},{provide:re,useFactory:ye,deps:[B,he,v,P],multi:!0}])}var ve={providers:[ie({eventCoalescing:!0}),ce(fe),ge("ngsw-worker.js",{enabled:!ne(),registrationStrategy:"registerWhenStable:30000"})]};function Ie(r,e){if(r&1&&(Y(0,"div",0),ee(1),J()),r&2){let i=X();Z(),te(i.message)}}var O=class r{constructor(e){this._notificationService=e}_stopObservable$=new E;message="";isVisible=!1;ngOnInit(){this._notificationService.getNotification().pipe(W(this._stopObservable$)).subscribe(e=>{if(this.isVisible=!1,e){let{message:i,timeout:t}=e;this.isVisible=!0,this.message=i,setTimeout(()=>{this.isVisible=!1},t)}})}ngOnDestroy(){this._stopObservable$.next(null),this._stopObservable$.complete()}static \u0275fac=function(i){return new(i||r)(H(le))};static \u0275cmp=y({type:r,selectors:[["app-notification"]],inputs:{message:"message",isVisible:"isVisible"},standalone:!0,features:[C],decls:1,vars:1,consts:[["data-cy","notification","role","alert",1,"alert","alert-secondary"]],template:function(i,t){i&1&&z(0,Ie,2,1,"div",0),i&2&&q(t.isVisible?0:-1)},styles:["[_nghost-%COMP%]{position:absolute;display:block;bottom:0;width:100%;z-index:1000;padding:0 1rem}"]})};var I=class r{title="Mole Game";static \u0275fac=function(i){return new(i||r)};static \u0275cmp=y({type:r,selectors:[["app-root"]],standalone:!0,features:[C],decls:2,vars:0,template:function(i,t){i&1&&Q(0,"router-outlet")(1,"app-notification")},dependencies:[se,O],styles:["[_nghost-%COMP%]{display:block;height:100vh}"]})};oe(I,ve).catch(r=>console.error(r));
